# Tell Your Story 코드 점검 리포트 (2026-02-26)

## 1. 현재 상태 요약
- 백엔드 FastAPI 기본 플로우는 동작한다.
  - `GET /` 200
  - `POST /interview/start` 200
  - `POST /interview/chat` 정상 입력 200, 비정상 입력 422
- 프론트 인터뷰 UX는 MVP 수준으로 정리되어 있다.
  - 시작 API 연동
  - 에러 배너 + 재시도
  - 대화 기록 표시
  - Enter 전송 / Shift+Enter 줄바꿈
- Git/브랜치/원격 기본 구성은 완료된 상태다 (`main`, `origin` 연결).

## 2. 우선 점검해야 할 리스크/버그 후보

### High
1. 로컬 경로 이슈로 프론트 설치/빌드가 불안정할 수 있음
- 한글/클라우드 동기화 경로에서 `npm install`이 장시간 멈추는 현상이 재현됨.
- 영향: 개발자 환경에 따라 실행이 랜덤하게 실패.
- 권장: 프론트 작업/CI는 ASCII 로컬 경로 기준으로 고정.

2. LLM 모델/공급자 하드코딩으로 운영 시 실패 가능성
- `solar-pro2`와 `OPENAI_BASE_URL` 조합이 환경마다 다를 수 있음.
- 영향: 배포 환경에서 401/404/400 발생 가능.
- 권장: 모델명/엔드포인트를 환경 변수화.

3. 대화 히스토리 무제한 전송
- 프론트가 전체 히스토리를 계속 전송하고 백엔드도 그대로 사용함.
- 영향: 토큰 비용 증가, 지연 증가, 장시간 대화 시 품질 저하.
- 권장: 최근 N턴만 유지하거나 요약 메모리 전략 추가.

### Medium
1. 자동 테스트 부재
- API/유효성/프론트 상호작용에 대한 정식 테스트 파일이 없음.
- 영향: 리팩터링 시 회귀 위험.

2. 서비스 구조 불균형
- STT/TTS 서비스 파일은 있으나 API 라우트/프론트 연동이 없음.
- 영향: 코드 의도와 실제 기능 간 불일치.

3. 에러 관측성 부족
- 현재는 콘솔 출력 중심.
- 영향: 운영 장애 분석 어려움.
- 권장: 구조화 로그(요청 ID, endpoint, latency, error type) 적용.

### Low
1. 미사용 의존성 포함 가능성
- `langchain`, `langchain-openai`, `chromadb`는 현재 코드 경로에서 사용 흔적이 약함.
- 영향: 설치 시간/공격면/복잡도 증가.

2. 미사용 컴포넌트 존재
- `Microphone` 컴포넌트가 런타임 플로우에 연결되어 있지 않음.

## 3. 정리(Refactor/Cleanup) 권장 항목
1. 설정 정리
- 모델명, CORS origin, 타임아웃, 히스토리 턴 수를 `.env`로 승격.

2. 디렉터리 정리
- 로컬 임시 산출물(`.tmp_*`, 중첩 폴더 등) 주기 정리 루틴 추가.

3. 의존성 정리
- 백엔드 `requirements.txt`를 현재 사용 의존성 기준으로 최소화.

4. API 계약 명시
- `ChatRequest`, `ChatResponse` 예시를 README 또는 OpenAPI 설명에 명시.

5. 관측성/안정성
- 서버 로그 포맷 통일 + 예외 분류(ValidationError/AuthError/ProviderError).

## 4. 앞으로의 방향성 (권장 로드맵)

### Phase 1: 안정화 (1주)
- 목표: "누가 실행해도 동일하게 돌아가는 상태"
1. 환경 변수/설정 분리 완료
2. 경로 이슈 없는 실행 가이드 확정
3. 최소 회귀 테스트 추가 (백엔드 3~5개)

### Phase 2: 인터뷰 품질 고도화 (1~2주)
- 목표: "질문 품질과 대화 지속성 개선"
1. 히스토리 슬라이딩 윈도우(N턴) 적용
2. 세션 요약 메모리(핵심 키워드/타임라인) 도입
3. 실패 응답 UX 개선(재시도, 임시 저장)

### Phase 3: 제품화 (2주+)
- 목표: "실사용 가능한 자서전 생성 파이프라인"
1. 음성(STT/TTS) API 라우트 연결
2. 인터뷰 저장(세션/사용자 단위)
3. 결과물(초안/챕터) 생성 기능 추가

## 5. 다음 스프린트에서 바로 할 일 (실행 순서)
1. `config.py` 도입 및 모델/CORS/히스토리 턴수 환경 변수화
2. 백엔드 테스트 추가 (`/`, `/interview/start`, `/interview/chat`)
3. 대화 히스토리 최근 N턴 제한
4. `requirements.txt` 슬림화
5. STT/TTS를 실제 라우터에 연결할지, 아니면 코드 제거할지 결정

## 6. 완료 기준 (Definition of Done)
- 로컬/CI에서 백엔드 테스트 통과
- 프론트 lint/build 통과
- API 키 없는 환경에서도 기능/오류 UX가 일관되게 동작
- README만 보고 신규 개발자가 30분 내 실행 가능
